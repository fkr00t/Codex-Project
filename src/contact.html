<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kontak - Codex.Project</title>
    <link rel="icon" type="image/png" href="assets/images/codex.png">
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="assets/css/contact.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Loading Animation -->
    <div id="loading-overlay">
      <div class="spinner"></div>
    </div>
    <div id="header-placeholder"></div>
    <main>
        <section class="contact-hero">
            <div class="container">
                <h1>Kontak Kami</h1>
                <p class="contact-hero-sub">Silakan hubungi kami apabila ada pertanyaan, tawaran kerjasama, ataupun kritik dan saran melalui form di bawah ini</p>
            </div>
        </section>

        <section class="contact-section">
            <div class="container">
                <div class="contact-content">
                    <div class="contact-form-container">
                        <h2>Konsultasi Jasa Pembuatan Website</h2>
                        <form id="contactForm">
                            <div class="form-group">
                                <label for="name">Nama</label>
                                <input type="text" id="name" name="name" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" required>
                            </div>
                            <div class="form-group">
                                <label for="whatsapp">Nomor WhatsApp</label>
                                <input type="tel" id="whatsapp" name="whatsapp" pattern="[0-9]{10,15}" placeholder="" required>
                            </div>
                            <div class="form-group">
                                <label for="message">Tulis pesan atau permintaan Anda kepada kami.</label>
                                <textarea id="message" name="message" rows="6" required></textarea>
                            </div>
                            <button type="submit" class="submit-btn">Kirim Pesan</button>
                        </form>
                    </div>
                    
                    <div class="contact-info">
                        <h3>Informasi Kontak</h3>
                        <div class="contact-details">
                            <div class="contact-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <div>
                                    <h4>Alamat</h4>
                                    <p>Jl. Mawar Gg Coklat, Desa Biting, Kec.Arjasa, Kab.Jember, Indonesia.</p>
                                </div>
                            </div>
                            <a href="https://wa.me/6288230584013" class="contact-item" style="text-decoration: none; color: inherit;">
                                <i class="fab fa-whatsapp"></i>
                                <div>
                                    <h4>WhatsApp</h4>
                                    <p>+62 882-3058-4013</p>
                                </div>
                            </a> 
                            <a href="mailto:support@codexproject.dev" class="contact-item" style="text-decoration: none; color: inherit;">
                                <i class="fas fa-envelope"></i>
                                <div>
                                    <h4>Email</h4>
                                    <p>support@codexproject.dev</p>
                                </div>
                            </a>                                                    
                        </div>
                        
                        <div class="social-links">
                            <h4>Ikuti Kami</h4>
                            <div class="social-icons">
                                <a href="https://www.instagram.com/codex.project_" class="social-icon">
                                    <i class="fab fa-instagram"></i>
                                  </a>
                                  
                                  <a href="https://www.linkedin.com/company/codex-project/about" class="social-icon">
                                    <i class="fab fa-linkedin"></i>
                                  </a>
                                  
                                <!-- <a href="#" class="social-icon"><i class="fab fa-facebook"></i></a>
                                <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>
    <div id="footer-placeholder"></div>

    <script src="../src/assets/include-header-footer.js"></script>
    <script>
        // Loading overlay hide on page load
        window.addEventListener('load', function() {
          var overlay = document.getElementById('loading-overlay');
          if (overlay) {
            overlay.style.opacity = '0';
            overlay.style.pointerEvents = 'none';
            setTimeout(function() {
              overlay.style.display = 'none';
            }, 400);
          }
        });
        // Load header dan footer menggunakan includeHTML
        document.addEventListener('DOMContentLoaded', function() {
            includeHTML('#header-placeholder', '../header.html', function() {
                console.log('Header Loaded ✅');
                setTimeout(() => {
                    activateMenu();
                    initMobileNavbar();
                }, 100);
            });
            
            includeHTML('#footer-placeholder', '../footer.html', function() {
                console.log('Footer Loaded ✅');
            });
        });
        

        // Animasi typewriter untuk judul contact-hero
        document.addEventListener('DOMContentLoaded', function() {
            const contactHeroTitle = document.querySelector('.contact-hero h1');
            if (contactHeroTitle) {
                const text = contactHeroTitle.textContent;
                contactHeroTitle.textContent = '';
                let i = 0;
                const typeWriter = () => {
                    if (i < text.length) {
                        contactHeroTitle.textContent += text.charAt(i);
                        i++;
                        setTimeout(typeWriter, 50);
                    }
                };
                setTimeout(typeWriter, 500);
            }
        });

        // Fungsi sanitasi untuk form contact
        function sanitizeFormInput(input) {
            if (!input) return '';
            
            // Hapus karakter berbahaya
            const dangerousPatterns = [
                /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
                /javascript:/gi,
                /on\w+\s*=/gi,
                /<iframe/gi,
                /<object/gi,
                /<embed/gi,
                /<form/gi,
                /<input/gi,
                /<textarea/gi,
                /<select/gi,
                /<button/gi
            ];
            
            let sanitized = input.toString();
            dangerousPatterns.forEach(pattern => {
                sanitized = sanitized.replace(pattern, '');
            });
            
            // Batasi panjang
            if (sanitized.length > 1000) {
                sanitized = sanitized.substring(0, 1000);
            }
            
            return sanitized.trim();
        }

        // Form submission handling
        const contactForm = document.getElementById('contactForm');
        if (contactForm) {
            contactForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Tampilkan loading state
                const submitBtn = this.querySelector('.submit-btn');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'Mengirim...';
                submitBtn.disabled = true;
                
                try {
                    const formData = new FormData(this);
                    
                    // Sanitasi semua input
                    const data = {
                        name: sanitizeFormInput(formData.get('name')),
                        email: sanitizeFormInput(formData.get('email')),
                        whatsapp: sanitizeFormInput(formData.get('whatsapp')),
                        message: sanitizeFormInput(formData.get('message'))
                    };
                    
                    // Validasi email
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(data.email)) {
                        alert('Format email tidak valid!');
                        return;
                    }
                    
                    // Validasi nama
                    if (data.name.length < 2) {
                        alert('Nama harus minimal 2 karakter!');
                        return;
                    }
                    
                    // Validasi pesan
                    if (data.message.length < 10) {
                        alert('Pesan harus minimal 10 karakter!');
                        return;
                    }
                    
                    // Kirim data ke API
                    const response = await fetch('/api/contact', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data)
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        alert(result.message);
                        this.reset();
                    } else {
                        alert('Error: ' + result.message);
                    }
                    
                } catch (error) {
                    console.error('Error:', error);
                    alert('Terjadi kesalahan saat mengirim pesan. Silakan coba lagi nanti.');
                } finally {
                    // Reset button state
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }
            });
        }
        document.getElementById('whatsapp').addEventListener('input', function (e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    </script>
</body>
</html> 